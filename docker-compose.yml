version: "3"
services:
    mysql:
        image: mysql:5.7.41
        ports:
            - "3309:3306"
        volumes:
            - ./data/mysql:/var/lib/mysql
            - ./docker-config/mysql/init.sql:/docker-entrypoint-initdb.d/init.sql
            - ./docker-config/mysql/docker.cnf:/etc/mysql/conf.d/docker.cnf
        environment:
            MYSQL_ROOT_PASSWORD: root
            MYSQL_DATABASE: my_crud
            MYSQL_USER: testuser
            MYSQL_PASSWORD: testuser
        networks:
            - my_crud_network
    nginx:
        image: nginx
        ports: 
            - "8086:80"
        depends_on:
            - node           
        volumes:
            - ./docker-config/nginx/default.conf:/etc/nginx/conf.d/default.conf
            - ./frontend:/var/www/html
        networks:
            - my_crud_network
    node:
        image: node:15
        ports:
            - "9002:9002"
        depends_on:
            - mysql 
        volumes:
            - ./backend:/app
        environment:
            PORT: 9002
        working_dir: 
            "/app"
        command: app.js
        networks:
            - my_crud_network
networks:
    my_crud_network:
        driver: bridge
           
